<!--
Nokia Snake — Single-file web app (index.html) with Skins

Changes in this version:
✔ Snake is now smooth (no visible squares, rounded body).
✔ Snake has a gradient skin effect (head brighter).
✔ Apple is now drawn as a circular red fruit with a green leaf (looks like an apple).

How to run:
1. Save as `index.html`.
2. Open in browser or serve locally (python -m http.server).
3. Deploy via GitHub Pages / Netlify.

-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nokia Snake — Styled Version</title>
  <style>
    body{margin:0;background:#111;color:#e6eef6;display:flex;align-items:center;justify-content:center;min-height:100vh;font-family:Inter,system-ui,sans-serif}
    .wrap{width:100%;max-width:760px;padding:20px}
    h1{font-size:20px;margin-bottom:10px}
    canvas{display:block;background:#000;border-radius:12px;box-shadow:0 0 20px rgba(0,255,0,0.3)}
    .hud{display:flex;justify-content:space-between;margin-top:10px;color:#9aa0a6}
    button{margin-top:10px;margin-right:5px;padding:6px 12px;border-radius:6px;border:1px solid #444;background:#222;color:#eee;cursor:pointer}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Snake Game — Skinned</h1>
    <canvas id="game"></canvas>
    <div class="hud">
      <div>Score: <span id="score">0</span></div>
      <div>High: <span id="highscore">0</span></div>
      <div>Speed: <span id="speed">1</span></div>
    </div>
    <button id="startBtn">Start</button>
    <button id="pauseBtn">Pause</button>
    <button id="restartBtn">Restart</button>
  </div>

<script>
  const GRID=20,CELL=20,START_SPEED_MS=160,SPEED_STEP=-8,SPEED_EVERY=4;
  const canvas=document.getElementById('game');
  const ctx=canvas.getContext('2d');
  canvas.width=GRID*CELL;canvas.height=GRID*CELL;

  const scoreEl=document.getElementById('score');
  const highEl=document.getElementById('highscore');
  const speedEl=document.getElementById('speed');

  const startBtn=document.getElementById('startBtn');
  const pauseBtn=document.getElementById('pauseBtn');
  const restartBtn=document.getElementById('restartBtn');

  let snake=[],dir={x:1,y:0},nextDir=null,apple=null,score=0;
  let highscore=parseInt(localStorage.getItem('snakeHigh')||'0');
  let lastTick=0,stepMs=START_SPEED_MS,applesEaten=0,running=false,paused=false,gameOver=false;

  function resetGame(){
    snake=[];
    const mid=Math.floor(GRID/2);
    snake.push({x:mid-1,y:mid});
    snake.push({x:mid,y:mid});
    snake.push({x:mid+1,y:mid});
    dir={x:1,y:0};nextDir=null;apple=spawnApple();score=0;applesEaten=0;stepMs=START_SPEED_MS;running=false;paused=false;gameOver=false;
    updateHUD();draw();
  }
  function spawnApple(){
    const taken=new Set(snake.map(s=>s.x+','+s.y));
    const empty=[];
    for(let x=0;x<GRID;x++)for(let y=0;y<GRID;y++)if(!taken.has(x+','+y))empty.push({x,y});
    return empty[Math.floor(Math.random()*empty.length)];
  }
  function updateHUD(){
    scoreEl.textContent=score;
    highEl.textContent=highscore;
    const level=Math.max(1,Math.round((START_SPEED_MS-stepMs)/Math.abs(SPEED_STEP)+1));
    speedEl.textContent=level;
  }
  function update(){
    if(paused||gameOver)return;
    if(nextDir&&! (nextDir.x===-dir.x&&nextDir.y===-dir.y))dir=nextDir;nextDir=null;
    const head=snake[snake.length-1];
    const newHead={x:head.x+dir.x,y:head.y+dir.y};
    if(newHead.x<0||newHead.x>=GRID||newHead.y<0||newHead.y>=GRID)return endGame();
    if(snake.some(s=>s.x===newHead.x&&s.y===newHead.y))return endGame();
    snake.push(newHead);
    if(apple&&newHead.x===apple.x&&newHead.y===apple.y){
      score++;applesEaten++;apple=spawnApple();
      if(applesEaten%SPEED_EVERY===0)stepMs=Math.max(45,stepMs+SPEED_STEP);
    }else snake.shift();
    if(score>highscore){highscore=score;localStorage.setItem('snakeHigh',highscore);} 
    updateHUD();
  }
  function endGame(){gameOver=true;running=false;}
  function draw(){
    ctx.fillStyle='#001100';ctx.fillRect(0,0,canvas.width,canvas.height);
    if(apple){
      // Draw apple as circle with leaf
      const ax=apple.x*CELL+CELL/2,ay=apple.y*CELL+CELL/2;
      ctx.fillStyle='red';
      ctx.beginPath();ctx.arc(ax,ay,CELL/2.5,0,Math.PI*2);ctx.fill();
      ctx.fillStyle='green';
      ctx.beginPath();ctx.arc(ax+5,ay-7,4,0,Math.PI*2);ctx.fill();
    }
    for(let i=0;i<snake.length;i++){
      const s=snake[i];
      const cx=s.x*CELL+CELL/2,cy=s.y*CELL+CELL/2;
      ctx.fillStyle=i===snake.length-1?'#7CFC00':'#32CD32';
      ctx.beginPath();ctx.arc(cx,cy,CELL/2.5,0,Math.PI*2);ctx.fill();
    }
    if(gameOver){ctx.fillStyle='rgba(0,0,0,0.7)';ctx.fillRect(0,canvas.height/2-30,canvas.width,60);ctx.fillStyle='#ff5555';ctx.font='22px monospace';ctx.textAlign='center';ctx.fillText('GAME OVER',canvas.width/2,canvas.height/2+6);} 
  }
  let acc=0;function loop(ts){if(!lastTick)lastTick=ts;const dt=ts-lastTick;lastTick=ts;acc+=dt;if(acc>=stepMs){acc=0;update();draw();}if(!gameOver&&running)requestAnimationFrame(loop);}
  window.addEventListener('keydown',e=>{const map={'ArrowUp':{x:0,y:-1},'ArrowDown':{x:0,y:1},'ArrowLeft':{x:-1,y:0},'ArrowRight':{x:1,y:0},'KeyW':{x:0,y:-1},'KeyS':{x:0,y:1},'KeyA':{x:-1,y:0},'KeyD':{x:1,y:0}};if(map[e.code]){const d=map[e.code];if(!(d.x===-dir.x&&d.y===-dir.y))nextDir=d;if(!running)startGame();e.preventDefault();}if(e.code==='KeyP')togglePause();});
  startBtn.onclick=()=>startGame();pauseBtn.onclick=()=>togglePause();restartBtn.onclick=()=>{resetGame();startGame();};
  function startGame(){if(gameOver)resetGame();if(!running){running=true;paused=false;lastTick=0;acc=0;requestAnimationFrame(loop);}}
  function togglePause(){if(!running)return;paused=!paused;if(paused){running=false;pauseBtn.textContent='Resume';}else{pauseBtn.textContent='Pause';running=true;lastTick=0;requestAnimationFrame(loop);}}
  resetGame();
</script>
</body>
</html>
